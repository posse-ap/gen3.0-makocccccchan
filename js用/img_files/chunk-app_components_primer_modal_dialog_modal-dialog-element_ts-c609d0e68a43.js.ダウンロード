"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_primer_modal_dialog_modal-dialog-element_ts","app_components_primer_modal_dialog_iterate-focusable-elements_ts"],{35904(a,b,c){function d(a){document.activeElement!==a&&a?.focus()}function e(a,b=!1){return(function*(a,b={}){let c=b.strict?? !1,d=b.onlyTabbable?g:f,e=document.createTreeWalker(a,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>a instanceof HTMLElement&&d(a,c)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}),h=null;if(!b.reverse&&d(a,c)&&(yield a),b.reverse){let i=e.lastChild();for(;i;)h=i,i=e.lastChild()}else h=e.firstChild();for(;h instanceof HTMLElement;)yield h,h=b.reverse?e.previousNode():e.nextNode();b.reverse&&d(a,c)&&(yield a)})(a,{reverse:b,strict:!0,onlyTabbable:!0}).next().value}function f(a,b=!1){let c=["BUTTON","INPUT","SELECT","TEXTAREA","OPTGROUP","OPTION","FIELDSET"].includes(a.tagName)&&a.disabled,d=a.hidden,e=a instanceof HTMLInputElement&&"hidden"===a.type,f=a.classList.contains("sentinel");if(c||d||e||f)return!1;if(b){let g=0===a.offsetWidth||0===a.offsetHeight,h=["hidden","collapse"].includes(getComputedStyle(a).visibility),i=0===a.getClientRects().length;if(g||h||i)return!1}return null!=a.getAttribute("tabindex")||(!(a instanceof HTMLAnchorElement)||null!=a.getAttribute("href"))&& -1!==a.tabIndex}function g(a,b=!1){return f(a,b)&&"-1"!==a.getAttribute("tabindex")}c.r(b),c.d(b,{focusIfNeeded:()=>d,getFocusableChild:()=>e,isTabbable:()=>g})},94525(a,b,c){c.r(b),c.d(b,{ModalDialogElement:()=>ModalDialogElement});var d=c(35904);function e(a,b){if(b.has(a))throw TypeError("Cannot initialize the same private elements twice on an object")}function f(a,b,c){if(!b.has(a))throw TypeError("attempted to "+c+" private field on non-instance");return b.get(a)}function g(a,b){var c,d,e=f(a,b,"get");return c=a,(d=e).get?d.get.call(c):d.value}function h(a,b,c){e(a,b),b.set(a,c)}function i(a,b,c){var d=f(a,b,"set");return!function(a,b,c){if(b.set)b.set.call(a,c);else{if(!b.writable)throw TypeError("attempted to set read only private field");b.value=c}}(a,d,c),c}let j=[],k;function l(a,b,c){a.setAttribute("data-focus-trap","active");let e=document.createElement("span");e.setAttribute("class","sentinel"),e.setAttribute("tabindex","0"),e.setAttribute("aria-hidden","true"),e.onfocus=()=>{let b=(0,d.getFocusableChild)(a,!0);b?.focus()};let f=document.createElement("span");f.setAttribute("class","sentinel"),f.setAttribute("tabindex","0"),f.setAttribute("aria-hidden","true"),f.onfocus=()=>{let b=(0,d.getFocusableChild)(a);b?.focus()},a.prepend(e),a.append(f);let g;function h(b){if(b instanceof HTMLElement&&document.contains(a)){if(a.contains(b)){g=b;return}if(g&&(0,d.isTabbable)(g)&&a.contains(g)){(0,d.focusIfNeeded)(g);return}if(c&&a.contains(c)){(0,d.focusIfNeeded)(c);return}{let e=(0,d.getFocusableChild)(a);(0,d.focusIfNeeded)(e);return}}}let i=function(a){let b=new AbortController;return a.addEventListener("abort",()=>{b.abort()}),b}(b);if(k){let m=k;k.container.setAttribute("data-focus-trap","suspended"),k.controller.abort(),j.push(m)}i.signal.addEventListener("abort",()=>{k=void 0}),b.addEventListener("abort",()=>{a.removeAttribute("data-focus-trap");let b=a.getElementsByClassName("sentinel");for(;b.length>0;)b[0].remove();let c=j.findIndex(b=>b.container===a);c>=0&&j.splice(c,1),function(){let a=j.pop();a&&l(a.container,a.originalSignal,a.initialFocus)}()}),document.addEventListener("focus",a=>{h(a.target)},{signal:i.signal,capture:!0}),h(document.activeElement),k={container:a,controller:i,initialFocus:c,originalSignal:b};let n=j.findIndex(b=>b.container===a);n>=0&&j.splice(n,1)}var m=new WeakMap,n=new WeakMap,o=new WeakMap,p=new WeakMap,q=new WeakMap,r=new WeakSet;class ModalDialogElement extends HTMLElement{get open(){return this.hasAttribute("open")}set open(a){if(a)this.open||(this.setAttribute("open",""),g(this,q)?.classList.remove("Overlay--hidden"),document.body.style.overflow="hidden",g(this,m).signal.aborted&&i(this,m,new AbortController),l(this,g(this,m).signal));else{if(!this.open)return;this.removeAttribute("open"),g(this,q)?.classList.add("Overlay--hidden"),document.body.style.overflow="initial",g(this,m).abort();let b=g(this,o)?.closest("details")||g(this,o)?.closest("action-menu");b?(0,d.focusIfNeeded)((0,d.getFocusableChild)(b)):(0,d.focusIfNeeded)(g(this,o)),i(this,o,void 0)}}get showButtons(){return document.querySelectorAll(`button[data-show-dialog-id='${this.id}']`)}get includeFragment(){return this.querySelector('[data-target~="modal-dialog.include-fragment"]')}async loadHTMLFragment(){if(g(this,p)){i(this,p,!1);try{let a=await this.includeFragment?.load();return a}catch(b){i(this,p,!0);return}}}connectedCallback(){this.hasAttribute("role")||this.setAttribute("role","dialog");let{signal:a}=i(this,n,new AbortController);if(this.hasAttribute("preload")){let b=this.showButtons;for(let c of b)c?.addEventListener("mouseenter",this.loadHTMLFragment.bind(this),{signal:a}),c?.addEventListener("focus",this.loadHTMLFragment.bind(this),{signal:a})}this.ownerDocument.addEventListener("click",a=>{let b=a.target,c=b.closest(this.tagName)!==this,d=b?.closest("button");if(!d){c&&this.close();return}let e=d.getAttribute("data-close-dialog-id");e===this.id&&this.close(),(e=d.getAttribute("data-submit-dialog-id"))===this.id&&this.close(!0),(e=d.getAttribute("data-show-dialog-id"))===this.id&&(a.stopPropagation(),i(this,o,d),this.show())},{signal:a}),this.addEventListener("keydown",a=>(function(a,b,c){if(!b.has(a))throw TypeError("attempted to get private field on non-instance");return c})(this,r,s).call(this,a))}disconnectedCallback(){g(this,n)?.abort()}show(){this.open=!0}close(a=!1){if(!1===this.open)return;let b=a?"close":"cancel",c=new Event(b);this.dispatchEvent(c),this.open=!1}constructor(...a){var b,c;super(...a),h(this,q,{get:function(){return this.parentElement?.hasAttribute("data-modal-dialog-overlay")?this.parentElement:null},set:void 0}),b=this,e(b,c=r),c.add(b),h(this,m,{writable:!0,value:new AbortController}),h(this,n,{writable:!0,value:null}),h(this,o,{writable:!0,value:void 0}),h(this,p,{writable:!0,value:!0})}}function s(a){a instanceof KeyboardEvent&& !a.isComposing&&"Escape"===a.key&&this.open&&(this.close(),a.preventDefault(),a.stopPropagation())}window.customElements.get("modal-dialog")||(window.ModalDialogElement=ModalDialogElement,window.customElements.define("modal-dialog",ModalDialogElement))}}])
//# sourceMappingURL=app_components_primer_modal_dialog_modal-dialog-element_ts-c83b829cc59e.js.map